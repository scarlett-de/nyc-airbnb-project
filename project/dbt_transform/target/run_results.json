{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-27T15:14:53.084705Z", "invocation_id": "f868acbd-b6d8-4f21-be02-7395307dea92", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-27T15:14:48.858656Z", "completed_at": "2025-03-27T15:14:48.865677Z"}, {"name": "execute", "started_at": "2025-03-27T15:14:48.866102Z", "completed_at": "2025-03-27T15:14:52.964428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.10949969291687, "adapter_response": {"_message": "CREATE TABLE (48.9k rows, 7.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 48895, "bytes_processed": 7989346, "bytes_billed": 10485760, "location": "US", "project_id": "decamp-project-52560", "job_id": "a53389f9-d4a3-4aba-a6ee-9aff2a02ee7a", "slot_ms": 5599}, "message": "CREATE TABLE (48.9k rows, 7.6 MiB processed)", "failures": null, "unique_id": "model.dbt_transform.fact_listings", "compiled": true, "compiled_code": "WITH listings AS (\n    SELECT\n        listing_name,\n        price,\n        listing_id,\n        host_id,\n        room_type,\n        neighbourhood_group,\n        neighbourhood,\n        minimum_nights,\n        number_of_reviews,\n        last_review_date,\n        reviews_per_month,\n        calculated_host_listings_count,\n        availability_365,\n        latitude,\n        longitude\n    FROM `decamp-project-52560`.`ny_airbnb_staging_dataset`.`stg_listings`\n)\n\nSELECT\n   host_id,\n  listing_id,\n  listing_name,\n   neighbourhood_group,\n   neighbourhood,\n    room_type,\n  -- Facts/measures\n  price,\n  minimum_nights,\n  number_of_reviews,\n  reviews_per_month,\n  availability_365,\n  calculated_host_listings_count,\n  \n  -- Derived metrics\n  price * availability_365 AS potential_annual_revenue,\n  \n  CASE \n    WHEN availability_365 = 0 THEN 0 \n    ELSE ROUND(price * 365 / NULLIF(availability_365, 0), 2)\n  END AS implied_daily_rate,\n  \n  -- Business flags\n  CASE WHEN number_of_reviews > 0 THEN 1 ELSE 0 END AS has_reviews_flag,\n  CASE WHEN last_review_date IS NULL THEN 1 ELSE 0 END AS never_reviewed_flag,\n  CASE WHEN availability_365 = 0 THEN 1 ELSE 0 END AS fully_booked_flag,\n  \n  -- Temporal dimensions\n  EXTRACT(YEAR FROM last_review_date) AS last_review_year,\n  FORMAT_DATE('%Y-%m', last_review_date) AS last_review_ym,\n  \n  -- Geolocation\n  latitude,\n  longitude,\n  \n  -- Metadata\n  CURRENT_TIMESTAMP() AS dbt_loaded_at\nFROM listings", "relation_name": "`decamp-project-52560`.`ny_airbnb_analytics_dataset`.`fact_listings`", "batch_results": null}], "elapsed_time": 6.684298276901245, "args": {"skip_nodes_if_on_run_start_fails": false, "empty": false, "select": ["fact_listings"], "require_yaml_configuration_for_mf_time_spines": false, "quiet": false, "require_resource_names_without_spaces": false, "write_json": true, "favor_state": false, "log_file_max_bytes": 10485760, "show_resource_report": false, "defer": false, "log_level_file": "debug", "partial_parse": true, "project_dir": "/Users/yitian66/Documents/DE-Datacamp/Project/dbt_transform", "use_colors": true, "version_check": true, "print": true, "invocation_command": "dbt run -m fact_listings", "cache_selected_only": false, "printer_width": 80, "exclude": [], "introspect": true, "partial_parse_file_diff": true, "profiles_dir": "/Users/yitian66/Documents/DE-Datacamp/Project/dbt_transform", "log_format_file": "debug", "require_nested_cumulative_type_params": false, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "state_modified_compare_more_unrendered_values": false, "macro_debugging": false, "use_colors_file": true, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager", "strict_mode": false, "log_path": "/Users/yitian66/Documents/DE-Datacamp/Project/dbt_transform/logs", "vars": {}, "populate_cache": true, "log_level": "info", "state_modified_compare_vars": false, "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "log_format": "default", "source_freshness_run_project_hooks": false, "which": "run"}}